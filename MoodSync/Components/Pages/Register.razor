@page "/register"
@using Microsoft.EntityFrameworkCore
@using MoodSync.Data
@using MoodSync.Models
@inject ApplicationDbContext DbContext
@inject NavigationManager NavigationManager

@code {
    private UserCredentialsData newUser = new UserCredentialsData();
    private string errorMessage;

    private async Task RegisterUser()
    {
        var existingUser = await DbContext.Users
            .FirstOrDefaultAsync(u => u.UserName == newUser.UserName);

        if (existingUser != null)
        {
            errorMessage = "Username already exists!";
            return;
        }

        DbContext.Users.Add(newUser);
        await DbContext.SaveChangesAsync();

        NavigationManager.NavigateTo("/login");
    }
}
<div class="register-form">
    <h2>Register</h2>
    @if (!string.IsNullOrEmpty(errorMessage))
    {
        <div class="error-message">@errorMessage</div>
    }

    <input @bind="newUser.UserName" placeholder="Username" />
    <input @bind="newUser.Password" type="password" placeholder="Password" />
    <input @bind="newUser.Email" placeholder="Email" />
    <button @onclick="RegisterUser">Register</button>
</div>
